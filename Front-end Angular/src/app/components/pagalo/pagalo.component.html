<app-header></app-header>
<div class="flex justify-center items-center min-h-screen bg-white p-5">
  <div class="max-w-lg w-full p-8 rounded-xl bg-gray-800 shadow-2xl border border-gray-700 mt-20">
    <h1 class="text-center text-4xl font-bold text-white mb-6 tracking-tight">Págalo</h1>
    <p class="text-center mb-6 text-gray-400">Elige tu método de pago preferido</p>

    <form (ngSubmit)="onSubmit()" #paymentForm="ngForm">
      <!-- Código del Pedido -->
      <div class="mb-6">
        <label for="orderCode" class="block mb-2 text-sm font-medium text-gray-300">Código de orden</label>
        <input
          type="number"
          id="orderCode"
          [(ngModel)]="paymentDetails.orderCode"
          name="orderCode"
          placeholder="Ingrese el código de orden"
          required
          #orderCode="ngModel"
          class="w-full p-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 transition"
          [ngClass]="{ 'border-red-500 ring-2 ring-red-500': orderCode.invalid && orderCode.touched }"
        />
        <div *ngIf="orderCode.invalid && orderCode.touched" class="text-red-400 text-sm mt-2">
          El código del pedido es requerido.
        </div>
        <p class="text-gray-500 text-xs mt-2">Encuentre el código en su recibo</p>
      </div>

      <!-- Métodos de Pago -->
      <div class="mb-6">
        <h2 class="text-lg font-semibold text-white mb-4">Método de Pago</h2>
        <div class="grid grid-cols-3 gap-4">
          <div 
            class="text-center p-4 bg-gray-700 rounded-lg cursor-pointer transition duration-300 transform hover:scale-105"
            [ngClass]="{'ring-2 ring-cyan-500 bg-gray-600': paymentDetails.method === 'bcp'}" 
            (click)="selectPaymentMethod('bcp')">
            <img src="assets/images-pagalo/bcp.png" alt="BCP" class="w-12 h-auto mx-auto opacity-80 hover:opacity-100" />
            <span class="block mt-2 text-gray-300">BCP</span>
          </div>
          <div 
            class="text-center p-4 bg-gray-700 rounded-lg cursor-pointer transition duration-300 transform hover:scale-105"
            [ngClass]="{'ring-2 ring-cyan-500 bg-gray-600': paymentDetails.method === 'yape'}" 
            (click)="selectPaymentMethod('yape')">
            <img src="assets/images-pagalo/yape.png" alt="Yape" class="w-12 h-auto mx-auto opacity-80 hover:opacity-100" />
            <span class="block mt-2 text-gray-300">Yape</span>
          </div>
          <div 
            class="text-center p-4 bg-gray-700 rounded-lg cursor-pointer transition duration-300 transform hover:scale-105"
            [ngClass]="{'ring-2 ring-cyan-500 bg-gray-600': paymentDetails.method === 'plin'}" 
            (click)="selectPaymentMethod('plin')">
            <img src="assets/images-pagalo/plin.png" alt="Plin" class="w-12 h-auto mx-auto opacity-80 hover:opacity-100" />
            <span class="block mt-2 text-gray-300">Plin</span>
          </div>
        </div>
        <div *ngIf="paymentDetails.method" class="text-center mt-4 text-gray-400">
          Método seleccionado: {{ paymentDetails.method | uppercase }}
        </div>

        <!-- QR Codes -->
        <div *ngIf="paymentDetails.method === 'yape' || paymentDetails.method === 'plin'" 
             class="flex justify-center my-6 animate-fade-in">
          <img src="assets/images-pagalo/qr.png" alt="Código QR" 
               class="max-w-xs rounded-lg shadow-lg opacity-90 hover:opacity-100 transition" />
        </div>
      </div>

      <!-- Clave -->
      <div class="mb-6">
        <label for="password" class="block mb-2 text-sm font-medium text-gray-300">Clave</label>
        <input
          type="password"
          id="password"
          [(ngModel)]="paymentDetails.password"
          name="password"
          placeholder="Ingrese su clave"
          required
          #password="ngModel"
          class="w-full p-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 transition"
          [ngClass]="{ 'border-red-500 ring-2 ring-red-500': password.invalid && password.touched }"
        />
        <div *ngIf="password.invalid && password.touched" class="text-red-400 text-sm mt-2">
          La clave es requerida.
        </div>
      </div>

      <!-- Detalles de Tarjeta (solo BCP) -->
      <div *ngIf="paymentDetails.method === 'bcp'" class="mb-6 animate-fade-in">
        <h3 class="text-lg font-semibold text-white mb-4">Detalles de la Tarjeta</h3>
        <div class="space-y-4">
          <div>
            <label for="cardNumber" class="block mb-2 text-sm font-medium text-gray-300">Número de Tarjeta</label>
            <input
              type="number"
              id="cardNumber"
              [(ngModel)]="paymentDetails.cardNumber"
              name="cardNumber"
              placeholder="Ingrese el número de la tarjeta"
              required
              #cardNumber="ngModel"
              class="w-full p-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 transition"
              [ngClass]="{ 'border-red-500 ring-2 ring-red-500': cardNumber.invalid && cardNumber.touched }"
            />
            <div *ngIf="cardNumber.invalid && cardNumber.touched" class="text-red-400 text-sm mt-2">
              El número de tarjeta es requerido.
            </div>
          </div>
          <div class="grid grid-cols-2 gap-4">
            <div>
              <label for="cardExpiry" class="block mb-2 text-sm font-medium text-gray-300">Fecha de Expiración</label>
              <input
                type="month"
                id="cardExpiry"
                [(ngModel)]="paymentDetails.cardExpiry"
                name="cardExpiry"
                required
                #cardExpiry="ngModel"
                class="w-full p-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 transition"
                [ngClass]="{ 'border-red-500 ring-2 ring-red-500': cardExpiry.invalid && cardExpiry.touched }"
              />
              <div *ngIf="cardExpiry.invalid && cardExpiry.touched" class="text-red-400 text-sm mt-2">
                Fecha de expiración requerida.
              </div>
            </div>
            <div>
              <label for="cardCvv" class="block mb-2 text-sm font-medium text-gray-300">CVV</label>
              <input
                type="number"
                id="cardCvv"
                [(ngModel)]="paymentDetails.cardCvv"
                name="cardCvv"
                placeholder="CVV"
                required
                #cardCvv="ngModel"
                class="w-full p-3 bg-gray-700 text-white rounded-lg focus:outline-none focus:ring-2 focus:ring-cyan-500 transition"
                [ngClass]="{ 'border-red-500 ring-2 ring-red-500': cardCvv.invalid && cardCvv.touched }"
              />
              <div *ngIf="cardCvv.invalid && cardCvv.touched" class="text-red-400 text-sm mt-2">
                CVV requerido.
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Resumen de Pago -->
      <div *ngIf="paymentForm.valid" class="mb-6 p-4 bg-gray-700 rounded-lg border border-gray-600">
        <h3 class="text-lg font-semibold text-white mb-3">Resumen de Pago</h3>
        <div class="space-y-2">
          <p class="text-gray-300"><strong class="text-white">Código de Orden:</strong> {{ paymentDetails.orderCode }}</p>
          <p class="text-gray-300"><strong class="text-white">Método de Pago:</strong> {{ paymentDetails.method | uppercase }}</p>
        </div>
      </div>

      <!-- Botones -->
      <div class="space-y-4">
        <button 
          type="submit" 
          [disabled]="!paymentForm.form.valid || !paymentDetails.method" 
          class="w-full p-3 bg-cyan-600 text-white rounded-lg cursor-pointer transition duration-300 
                 hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-cyan-500 disabled:opacity-50">
          Confirmar Pago
        </button>
        <button 
          type="button" 
          (click)="clearForm()" 
          class="w-full p-3 bg-red-600 text-white rounded-lg cursor-pointer transition duration-300 
                 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500">
          Limpiar Formulario
        </button>
      </div>
    </form>
  </div>
</div>
