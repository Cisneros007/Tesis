<app-header></app-header>

<div class="flex justify-center items-start min-h-screen bg-gray-100 p-6">
  <div class="mt-5 w-full">
    <div class="bg-gradient-to-br p-12 rounded-lg shadow-lg w-full max-w-3xl mx-auto">
      <h1 class="text-4xl text-teal-800 font-bold mb-6 text-center">Rastrear tu Env√≠o</h1>
      
      <!-- Mapa arriba del formulario -->
      <app-mapa class="mb-6"></app-mapa>

      <div class="flex flex-col gap-10">
        <!-- Secci√≥n del formulario -->
        <div class="flex-1" *ngIf="!showTrackingInfo">
          <form (ngSubmit)="onSubmit()" #trackingForm="ngForm" class="bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-2xl text-teal-800 font-bold mb-4">Ingresa tus Datos</h2>

            <div class="mb-5">
              <label for="orderCode" class="block text-lg font-semibold text-teal-800 mb-2">C√≥digo de Pedido</label>
              <input 
                type="text" 
                id="orderCode" 
                [(ngModel)]="trackingDetails.orderCode" 
                name="orderCode" 
                required
                #orderCode="ngModel"
                [ngClass]="{'border-red-500': orderCode.invalid && orderCode.touched}" 
                class="w-full p-4 border rounded-lg shadow-inner transition focus:border-teal-700 focus:ring focus:ring-teal-300" 
                placeholder="Introduce el c√≥digo de tu pedido"
              >
              <div *ngIf="orderCode.invalid && orderCode.touched" class="text-red-600 text-sm mt-1">
                C√≥digo de pedido requerido.
              </div>
            </div>

            <div class="mb-5">
              <label for="password" class="block text-lg font-semibold text-teal-800 mb-2">Clave</label>
              <input 
                type="password" 
                id="password" 
                [(ngModel)]="trackingDetails.password" 
                name="password" 
                required
                #password="ngModel"
                [ngClass]="{'border-red-500': password.invalid && password.touched}" 
                class="w-full p-4 border rounded-lg shadow-inner transition focus:border-teal-700 focus:ring focus:ring-teal-300" 
                placeholder="Introduce tu clave"
              >
              <div *ngIf="password.invalid && password.touched" class="text-red-600 text-sm mt-1">
                La clave es requerida.
              </div>
            </div>

            <button type="submit" [disabled]="!trackingForm.form.valid" class="bg-teal-600 text-white rounded-full py-4 text-lg hover:bg-teal-700 transition-transform transform hover:scale-105 w-full">
              Rastrear Env√≠o
            </button>
          </form>
        </div>

        <!-- Secci√≥n de detalles del env√≠o -->
        <div class="flex-1" *ngIf="showTrackingInfo">
          <div class="bg-teal-50 p-6 rounded-lg shadow-md">
            <h2 class="text-2xl text-teal-800 font-bold mb-4">Detalles del Env√≠o</h2>

            <div class="grid grid-cols-2 gap-4 mb-5">
              <div class="bg-yellow-300 p-3 rounded-lg">
                <span>Fecha de Registro</span>
                <strong>{{ informacionEnvio.fechaRegistro }}</strong>
              </div>
              <div class="bg-yellow-300 p-3 rounded-lg">
                <span>Fecha de Entrega</span>
                <strong>{{ informacionEnvio.fechaEntrega }}</strong>
              </div>
              <div class="bg-yellow-300 p-3 rounded-lg">
                <span>Origen</span>
                <strong>{{ informacionEnvio.origen }}</strong>
              </div>
              <div class="bg-yellow-300 p-3 rounded-lg">
                <span>Destino</span>
                <strong>{{ informacionEnvio.destino }}</strong>
              </div>
            </div>

            <!-- Estado del env√≠o -->
            <div class="flex justify-around mb-5">
              <div class="flex flex-col items-center">
                <div class="text-3xl">üì¶</div>
                <div>Registrado</div>
                <div class="opacity-50" [class.opacity-100]="informacionEnvio.estado === 'registrado'"></div>
              </div>
              <div class="flex flex-col items-center">
                <div class="text-3xl">üöö</div>
                <div>En Ruta</div>
                <div class="opacity-50" [class.opacity-100]="informacionEnvio.estado === 'en-ruta'"></div>
              </div>
              <div class="flex flex-col items-center">
                <div class="text-3xl">‚úÖ</div>
                <div>Entregado</div>
                <div class="opacity-50" [class.opacity-100]="informacionEnvio.estado === 'entregado'"></div>
              </div>
            </div>

            <!-- Informaci√≥n adicional del env√≠o -->
            <div class="bg-white p-5 rounded-lg">
              <strong>INFORMACI√ìN DEL ENV√çO:</strong>
              <p>N¬∞ de Tracking: {{ informacionEnvio.numeroRastreo }}</p>
              <p><strong>Estado:</strong> {{ trackingInfo.status }}</p>
              <p><strong>Fecha de Env√≠o:</strong> {{ trackingInfo.shippedDate }}</p>
              <p><strong>Fecha de Entrega Estimada:</strong> {{ trackingInfo.estimatedDelivery }}</p>
              <p><strong>Ubicaci√≥n Actual:</strong> {{ trackingInfo.currentLocation }}</p>
            </div>

            <!-- Botones de acci√≥n -->
            <div class="flex justify-between mt-5">
              <button (click)="irAInicio()" class="bg-teal-600 text-white rounded-full py-2 px-4 hover:bg-teal-700 transition-transform transform hover:scale-105">
                Ir a Inicio
              </button>
              <button (click)="resetTracking()" class="bg-teal-600 text-white rounded-full py-2 px-4 hover:bg-teal-700 transition-transform transform hover:scale-105">
                Rastrear de Nuevo
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
